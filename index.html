<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>軽量YouTube再生リスト</title>
  <style>
    body { font-family: sans-serif; }
    .video-item { cursor: pointer; margin-bottom: 24px; }
    .video-item img { max-width: 100%; display: block; }
    iframe { width: 100%; max-width: 560px; height: 315px; }
  </style>
</head>
<body>

<h1>動画一覧（クリックで再生）</h1>
<div id="videos">読み込み中...</div>

<script>
document.addEventListener("DOMContentLoaded", () => {

  //AIzaSyAxk1YpQSe-qDtFUSUmnjnduanag41Mlyk
  const API_KEY = "（設定済み）";
  const PLAYLIST_ID = "PLsHj_P-wUyYnbIgioZx3iat9EzihpACzw";

  const container = document.getElementById("videos");

  async function fetchAll(pageToken = null, list = []) {
    let url =
      "https://www.googleapis.com/youtube/v3/playlistItems" +
      "?part=snippet" +
      "&maxResults=50" +
      `&playlistId=${PLAYLIST_ID}` +
      `&key=${API_KEY}`;

    if (pageToken) url += `&pageToken=${pageToken}`;

    const res = await fetch(url);
    if (!res.ok) throw new Error("HTTP " + res.status);

    const data = await res.json();
    if (data.items) list.push(...data.items);

    return data.nextPageToken
      ? fetchAll(data.nextPageToken, list)
      : list;
  }

  fetchAll()
    .then(items => {
      container.innerHTML = "";

      if (!items.length) {
        container.textContent = "動画が見つかりませんでした。";
        return;
      }

      items.forEach(item => {
        const snip = item.snippet;
        if (!snip?.resourceId?.videoId) return;

        const div = document.createElement("div");
        div.className = "video-item";

        div.innerHTML = `
          <img src="${snip.thumbnails.medium.url}">
          <p>${snip.title}</p>
        `;

        div.onclick = () => {
          div.innerHTML = `
            <iframe
              src="https://www.youtube.com/embed/${snip.resourceId.videoId}?rel=0"
              frameborder="0"
              allowfullscreen
              loading="lazy">
            </iframe>
          `;
        };

        container.appendChild(div);
      });
    })
    .catch(err => {
      console.error(err);
      container.textContent = "APIエラーが発生しました。";
    });

});
</script>

</body>
</html>
