<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>軽量動画リスト</title>
  <style>
    .video-item { cursor: pointer; margin-bottom: 20px; }
    .video-item img { max-width: 100%; display: block; }
    iframe { width: 100%; max-width: 560px; height: 315px; }
  </style>
</head>
<body>
  <h1>動画一覧（クリックで再生）</h1>
  <div id="videos">読み込み中...</div>

  <script>
    document.addEventListener("DOMContentLoaded", function () {

      const apiKey = "あなたのAPIキー";
      const playlistId = "PLsHj_P-wUyYnbIgioZx3iat9EzihpACzw";
      const container = document.getElementById("videos");

      async function fetchAllVideos(pageToken = "", allItems = []) {
        const url =
          `https://www.googleapis.com/youtube/v3/playlistItems?part=snippet` +
          `&maxResults=50` +
          `&playlistId=${playlistId}` +
          `&key=${apiKey}` +
          `&pageToken=${pageToken}`;

        const res = await fetch(url);
        const data = await res.json();

        if (data.items) allItems = allItems.concat(data.items);
        if (data.nextPageToken)
          return fetchAllVideos(data.nextPageToken, allItems);

        return allItems;
      }

      fetchAllVideos()
        .then(items => {
          container.innerHTML = "";

          if (!items.length) {
            container.innerText = "動画が見つかりませんでした。";
            return;
          }

          items.forEach(item => {
            if (!item.snippet.resourceId.videoId) return;

            const title = item.snippet.title;
            const videoId = item.snippet.resourceId.videoId;
            const thumbnail = item.snippet.thumbnails.medium.url;

            const div = document.createElement("div");
            div.className = "video-item";

            div.innerHTML = `
              <img src="${thumbnail}" alt="${title}">
              <p>${title}</p>
            `;

            div.onclick = () => {
              div.innerHTML =
                `<iframe src="https://www.youtube.com/embed/${videoId}?rel=0"`
                + ` frameborder="0" allowfullscreen loading="lazy"></iframe>`;
            };

            container.appendChild(div);
          });
        })
        .catch(err => {
          container.innerText = "APIエラーが発生しました。";
          console.error(err);
        });

    });
  </script>
</body>
</html>
