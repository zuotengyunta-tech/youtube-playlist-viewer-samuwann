<!doctype html>
<meta charset="utf-8">
<title>マキシマム</title>
<style>
  body{font:16px/1.5 system-ui;margin:20px;background:#fff}
  #out{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:12px;margin-top:16px}
  .card{border:1px solid #ddd;border-radius:8px;overflow:hidden;background:#fafafa;cursor:pointer}
  .card img{width:100%;display:block}
  .card h3{font-size:14px;margin:6px;line-height:1.3}
</style>

<p>
  キーワード:
  <input id="q" value="添い寝ラジオ" size="20" readonly>
  件数:
  <input id="n" value="10" readonly>
  <button id="go">検索</button>
</p>

<div id="out"></div>

<script>
const FIXED_KEY   = "AIzaSyAxk1YpQSe-qDtFUSUmnjnduanag41Mlyk";
const FIXED_QUERY = "添い寝ラジオ";
const FIXED_MAX   = 10; // ← 新着10件固定

async function run(){
  out.textContent = "読み込み中...";

  const u = new URL("https://www.googleapis.com/youtube/v3/search");
  u.search = new URLSearchParams({
    part: "snippet",
    q: FIXED_QUERY,
    order: "date",      // 新着順
    type: "video",
    maxResults: FIXED_MAX,
    key: FIXED_KEY
  });

  try{
    const r  = await fetch(u);
    const js = await r.json();

    if(!r.ok){
      out.textContent = "取得失敗: " + (js?.error?.message || r.status);
      return;
    }

    if(!js.items?.length){
      out.textContent = "動画なし";
      return;
    }

    out.innerHTML = "";
    js.items.forEach(v=>{
      const id = v.id.videoId;
      const sn = v.snippet;

      const card = document.createElement("div");
      card.className = "card";
      card.innerHTML = `
        <img src="${sn.thumbnails.medium.url}">
        <h3>${sn.title}</h3>
      `;
      card.onclick = ()=>{
        card.innerHTML = `
          <iframe width="100%" height="200"
            src="https://www.youtube.com/embed/${id}?autoplay=1"
            frameborder="0"
            allow="autoplay; encrypted-media"
            allowfullscreen>
          </iframe>
        `;
      };
      out.appendChild(card);
    });

  }catch(e){
    out.textContent = "取得失敗: " + e.message;
  }
}

document.getElementById("go").onclick = run;
</script>
