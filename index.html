<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>è»½é‡YouTubeå†ç”Ÿãƒªã‚¹ãƒˆ</title>
  <style>
    body { font-family: sans-serif; }
    .video-item { cursor: pointer; margin-bottom: 24px; }
    .video-item img { max-width: 100%; display: block; }
    iframe { width: 100%; max-width: 560px; height: 315px; }
  </style>
</head>
<body>

<h1>å‹•ç”»ä¸€è¦§ï¼ˆã‚¯ãƒªãƒƒã‚¯ã§å†ç”Ÿï¼‰</h1>
<div id="videos">èª­ã¿è¾¼ã¿ä¸­...</div>

<script>
document.addEventListener("DOMContentLoaded", () => {

  // ğŸ” ã“ã“ã«ã‚ãªãŸã®APIã‚­ãƒ¼ï¼ˆã™ã§ã«è¨­å®šæ¸ˆã¿æƒ³å®šï¼‰
  const API_KEY = "ï¼ˆè¨­å®šæ¸ˆã¿ï¼‰";
  const PLAYLIST_ID = "PLsHj_P-wUyYnbIgioZx3iat9EzihpACzw";

  const container = document.getElementById("videos");

  async function fetchAll(pageToken = null, list = []) {
    let url =
      "https://www.googleapis.com/youtube/v3/playlistItems" +
      "?part=snippet" +
      "&maxResults=50" +
      `&playlistId=${PLAYLIST_ID}` +
      `&key=${API_KEY}`;

    if (pageToken) url += `&pageToken=${pageToken}`;

    const res = await fetch(url);
    if (!res.ok) throw new Error("HTTP " + res.status);

    const data = await res.json();
    if (data.items) list.push(...data.items);

    return data.nextPageToken
      ? fetchAll(data.nextPageToken, list)
      : list;
  }

  fetchAll()
    .then(items => {
      container.innerHTML = "";

      if (!items.length) {
        container.textContent = "å‹•ç”»ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚";
        return;
      }

      items.forEach(item => {
        const snip = item.snippet;
        if (!snip?.resourceId?.videoId) return;

        const div = document.createElement("div");
        div.className = "video-item";

        div.innerHTML = `
          <img src="${snip.thumbnails.medium.url}">
          <p>${snip.title}</p>
        `;

        div.onclick = () => {
          div.innerHTML = `
            <iframe
              src="https://www.youtube.com/embed/${snip.resourceId.videoId}?rel=0"
              frameborder="0"
              allowfullscreen
              loading="lazy">
            </iframe>
          `;
        };

        container.appendChild(div);
      });
    })
    .catch(err => {
      console.error(err);
      container.textContent = "APIã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚";
    });

});
</script>

</body>
</html>
